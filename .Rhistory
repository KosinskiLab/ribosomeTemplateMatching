scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
upper = cowplot::plot_grid(plotlist = list(p1), labels = "A", label_size = 20)
middle = cowplot::plot_grid(plotlist = list(p2, p3), labels = c("B", "C"), label_size = 20)
lower = cowplot::plot_grid(plotlist = list(p4), labels = c("D"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle), nrow = 2, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosome.pdf",
total, width = 16, height = 12)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotalPicking.pdf",
total, width = 16, height = 18)
radialAverages = fread("/Users/vmaurer/Desktop/radialAverages.tsv")
bins = sort(unique(radialAverages$bin))
vals = seq(min(bins), max(bins), .1)
sphereTheory = data.table(
class = "Sphere [Theory]", bin = vals, value = abs(besselJ(vals, nu = 1)/vals)
)
sphereTheory[is.na(value), value := 1]
radialAverages = rbindlist(list(radialAverages, sphereTheory))
radialAverages[, value := (value - min(value))/(max(value) - min(value)), by = class]
radialAverages[, Class := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Ribosome (7p6z)", "Sphere", "Emoji", "Sphere [Theory]", "Rectangle [Theory]"))
]
radialAverages[, Linetype := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Practical", "Practical", "Practical", "Theory", "Theory"))
]
# radialAverages = radialAverages[!is.na(Class)]
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
p6
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/radialAverages.pdf",
p6, width = 8, height = 6)
middle = cowplot::plot_grid(plotlist = list(p2, p6), labels = c("B", "C"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
+ true_positives,
p1 = ggplot(estimates, aes(x = false_positives + true_positives,
y = true_positives / nrow(ground_truth),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(1, 20),
breaks = c(1, 5, 10, 15, 20)
)+
scale_y_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Number of picked particles")+
ylab("Recall")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(1, 20),
breaks = c(1, 5, 10, 15, 20)
)+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
upper = cowplot::plot_grid(plotlist = list(p1), labels = "A", label_size = 20)
middle = cowplot::plot_grid(plotlist = list(p2, p3), labels = c("B", "C"), label_size = 20)
lower = cowplot::plot_grid(plotlist = list(p4), labels = c("D"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle), nrow = 2, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosome.pdf",
total, width = 16, height = 12)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotalPicking.pdf",
total, width = 16, height = 18)
radialAverages = fread("/Users/vmaurer/Desktop/radialAverages.tsv")
bins = sort(unique(radialAverages$bin))
vals = seq(min(bins), max(bins), .1)
sphereTheory = data.table(
class = "Sphere [Theory]", bin = vals, value = abs(besselJ(vals, nu = 1)/vals)
)
sphereTheory[is.na(value), value := 1]
radialAverages = rbindlist(list(radialAverages, sphereTheory))
radialAverages[, value := (value - min(value))/(max(value) - min(value)), by = class]
radialAverages[, Class := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Ribosome (7p6z)", "Sphere", "Emoji", "Sphere [Theory]", "Rectangle [Theory]"))
]
radialAverages[, Linetype := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Practical", "Practical", "Practical", "Theory", "Theory"))
]
# radialAverages = radialAverages[!is.na(Class)]
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
p6
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/radialAverages.pdf",
p6, width = 8, height = 6)
middle = cowplot::plot_grid(plotlist = list(p2, p6), labels = c("B", "C"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
estimates
max(estimates$name)
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p1 = ggplot(estimates, aes(x = false_positives + true_positives,
y = true_positives / nrow(ground_truth),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Number of picked particles")+
ylab("Recall")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
upper = cowplot::plot_grid(plotlist = list(p1), labels = "A", label_size = 20)
middle = cowplot::plot_grid(plotlist = list(p2, p3), labels = c("B", "C"), label_size = 20)
lower = cowplot::plot_grid(plotlist = list(p4), labels = c("D"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle), nrow = 2, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosome.pdf",
total, width = 16, height = 12)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotalPicking.pdf",
total, width = 16, height = 18)
radialAverages = fread("/Users/vmaurer/Desktop/radialAverages.tsv")
bins = sort(unique(radialAverages$bin))
vals = seq(min(bins), max(bins), .1)
sphereTheory = data.table(
class = "Sphere [Theory]", bin = vals, value = abs(besselJ(vals, nu = 1)/vals)
)
sphereTheory[is.na(value), value := 1]
# rectangleTheory = data.table(
#   class = "Rectangle [Theory]", bin = vals, value = abs(besselJ(vals, nu = 0)**3)
# )
# rectangleTheory[is.na(value), value := 1]
radialAverages = rbindlist(list(radialAverages, sphereTheory))
radialAverages[, value := (value - min(value))/(max(value) - min(value)), by = class]
radialAverages[, Class := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Ribosome (7p6z)", "Sphere", "Emoji", "Sphere [Theory]", "Rectangle [Theory]"))
]
radialAverages[, Linetype := factor(class,
levels = c("ribosome", "sphere", "emoji", "Sphere [Theory]", "Rectangle [Theory]"),
labels = c("Practical", "Practical", "Practical", "Theory", "Theory"))
]
# radialAverages = radialAverages[!is.na(Class)]
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
p6
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/radialAverages.pdf",
p6, width = 8, height = 6)
middle = cowplot::plot_grid(plotlist = list(p2, p6), labels = c("B", "C"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
fwrite(estimates, "/Users/vmaurer/src/ribosomeSpheres/mappings.csv")
setwd("/Users/vmaurer/src/ribosomeSpheres")
estimate_paths = list.files("templates",recursive = T, full.names = T, pattern = "coordinates.tsv")
estimate_paths
p6
p6
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
p6
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/radialAverages.pdf",
p6, width = 8, height = 6)
middle = cowplot::plot_grid(plotlist = list(p2, p6), labels = c("B", "C"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middle, lower), nrow = 3, labels = NA)
ggsave("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
ggsave2("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
cowplot::ggsave2("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE, color = guide_legend(nrow = 2))
p6
library(cowplot)
middle = cowplot::plot_grid(plotlist = list(p2 + theme(legend.position = "None"), p6), labels = c("B", "C"), label_size = 20)
middle
middle = cowplot::plot_grid(plotlist = list(
()
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None")), labels = c("B", "C"), label_size = 20)
middle
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None"),
lgd), labels = c("B", "C", ""), label_size = 20, ncol = 2, rel_heights = c(.9, .1))
lgd = cowplot::get_legend(p6)
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None"),
lgd), labels = c("B", "C", ""), label_size = 20, ncol = 2, rel_heights = c(.9, .1))
middle
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
lgd = cowplot::get_legend(p6)
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None"),
lgd), labels = c("B", "C", ""), label_size = 20, ncol = 2, rel_heights = c(.9, .1))
middle
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None")), labels = c("B", "C"), label_size = 20, ncol = 2
)
middleTotal = cowplot::plot_grid(plotlist = list(middle, lgd), nrow = 2, rel_heights = c(.9, .1))
middleTotal
total = cowplot::plot_grid(plotlist = list(upper, middleTotal, lower), nrow = 3, labels = NA)
cowplot::ggsave2("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
p2 = ggplot(plot_data, aes(x = name, y = precision, group = Class, color = Class))+
)
p2 = ggplot(plot_data, aes(x = name, y = precision, group = Class, color = Class))+
geom_point()+
geom_line()+
ylab("true postives")+
scale_color_brewer(name = "Template", palette = "Set1")+
theme_bw(base_size = FONT_SIZE)+
xlab("Template radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = c(min(plot_data$name), 5, 10, 15, max(plot_data$name)))+
ylab("Precision")+
theme(legend.position = "bottom")
p2
plot_data = estimates[
, .(tp = sum(distance < DISTANCE_CUTOFF),
fp = sum(distance >= DISTANCE_CUTOFF)
), by = .(Class, name)
]
plot_data[, recall := tp / nrow(ground_truth), by = .(Class, name)]
plot_data[, precision := tp / (tp + fp), by = .(Class, name)]
p2 = ggplot(plot_data, aes(x = name, y = precision, group = Class, color = Class))+
geom_point()+
geom_line()+
ylab("true postives")+
scale_color_brewer(name = "Template", palette = "Set1")+
theme_bw(base_size = FONT_SIZE)+
xlab("Template radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = c(min(plot_data$name), 5, 10, 15, max(plot_data$name)))+
ylab("Precision")+
theme(legend.position = "bottom")
p2
plot_data = estimates[
, .(tp = sum(distance < DISTANCE_CUTOFF),
fp = sum(distance >= DISTANCE_CUTOFF)
), by = .(Class, name)
]
plot_data[, recall := tp / nrow(ground_truth), by = .(Class, name)]
FONT_SIZE = 20
DISTANCE_CUTOFF = 20
plot_data = estimates[
, .(tp = sum(distance < DISTANCE_CUTOFF),
fp = sum(distance >= DISTANCE_CUTOFF)
), by = .(Class, name)
]
plot_data[, recall := tp / nrow(ground_truth), by = .(Class, name)]
plot_data[, precision := tp / (tp + fp), by = .(Class, name)]
p2 = ggplot(plot_data, aes(x = name, y = precision, group = Class, color = Class))+
geom_point()+
geom_line()+
ylab("true postives")+
scale_color_brewer(name = "Template", palette = "Set1")+
theme_bw(base_size = FONT_SIZE)+
xlab("Template radius [Voxel]")+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(breaks = c(min(plot_data$name), 5, 10, 15, max(plot_data$name)))+
ylab("Precision")+
theme(legend.position = "bottom")
p2
lgd = cowplot::get_legend(p6)
middle = cowplot::plot_grid(plotlist = list(
p2 + theme(legend.position = "None"),
p6+ theme(legend.position = "None")), labels = c("B", "C"), label_size = 20, ncol = 2
)
middleTotal = cowplot::plot_grid(plotlist = list(middle, lgd), nrow = 2, rel_heights = c(.9, .1))
middle = cowplot::plot_grid(plotlist = list(p2, p6), labels = c("B", "C"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middleTotal, lower), nrow = 3, labels = NA)
cowplot::ggsave2("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
p6 = ggplot(radialAverages[bin < 10], aes(x = bin, y = value, color = Class))+
geom_line(mapping = aes(linetype = Linetype))+
# geom_line()+
geom_point()+
scale_color_brewer(name = "Template", palette = "Set1")+
ylab("Power spectrum average")+
xlab("Radius [Voxel]")+
scale_y_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
scale_x_continuous(breaks = seq(0, 10, 2))+
theme_bw(base_size = FONT_SIZE)+
theme(legend.position = "bottom")+
guides(linetype = FALSE)
p6
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
scale_x_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
scale_x_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
facet_grid(~Class, sacles = "free")+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, breaks = c(0, .2, .4, .6, .8))+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, breaks = c(0, 20, 40, 70, .8))+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, limits = c(0, .8))+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
p4 = ggplot(estimates, aes(x = true_positivesRibosome / nrow(ground_truth),
y = true_positivesFAS / nrow(fas_particles),
color = name, group = name))+
geom_line(linewidth = 1.5)+
theme_bw(base_size = FONT_SIZE)+
scale_color_continuous_divergingx(name = "Radius [Voxel]",
palette = "RdYlBu",
mid = 10,
limits = c(min(estimates$name), max(estimates$name)),
breaks = c(min(estimates$name), 5, 10, 15, max(estimates$name))
)+
scale_y_continuous(labels = scales::percent, limits = c(0, .6))+
scale_x_continuous(labels = scales::percent)+
facet_grid(~Class)+
xlab("Sampled Recall FAS")+
ylab("Sampled Recall Ribosome")+
theme(legend.position = "bottom",
legend.key.width = unit(2, "cm"))
p4
lower = cowplot::plot_grid(plotlist = list(p4), labels = c("D"), label_size = 20)
total = cowplot::plot_grid(plotlist = list(upper, middleTotal, lower), nrow = 3, labels = NA)
cowplot::ggsave2("/Users/vmaurer/src/ribosomeSpheres/plots/templateMatchingRibosomeTotal.pdf",
total, width = 16, height = 18)
